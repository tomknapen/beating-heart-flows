[{"id":"cb03a6ee.c51ce8","type":"tab","label":"Deurbel","disabled":false,"info":""},{"id":"81b232fa.7ea2a","type":"tab","label":"Lights","disabled":false,"info":""},{"id":"c123c82a.2bd618","type":"tab","label":"WLED","disabled":false,"info":""},{"id":"3332df14.475c4","type":"tab","label":"Domotica","disabled":false,"info":""},{"id":"84c236a0.d32b58","type":"subflow","name":"Google Nest Cast","info":"","category":"","in":[{"x":40,"y":80,"wires":[{"id":"b1fbd0ed.c429b"},{"id":"55e56a51.8616e4"}]}],"out":[],"env":[],"color":"#DDAA99"},{"id":"6f1eb918.3cb018","type":"subflow","name":"Relay","info":"","category":"","in":[{"x":40,"y":40,"wires":[{"id":"e0d3f10f.b6248"}]}],"out":[{"x":360,"y":600,"wires":[{"id":"5774a88e.5793e8","port":0}]}],"env":[{"name":"location","type":"str","value":"","ui":{"icon":"font-awesome/fa-map-pin","type":"select","opts":{"opts":[{"l":{"en-US":"downstairs"},"v":"downstairs"},{"l":{"en-US":"upstairs"},"v":"upstairs"}]}}},{"name":"number","type":"str","value":"","ui":{"icon":"font-awesome/fa-sort-numeric-asc"}}],"color":"#3FADB5","inputLabels":["ON/OFF/TOGGLE"],"outputLabels":["state"],"icon":"font-awesome/fa-lightbulb-o"},{"id":"a6fb0933.f024a8","type":"mqtt-broker","z":"","name":"beating-heart-mqtt","broker":"192.168.1.201","port":"1883","clientid":"","usetls":false,"compatmode":false,"keepalive":"60","cleansession":true,"birthTopic":"","birthQos":"0","birthPayload":"","closeTopic":"","closeQos":"0","closePayload":"","willTopic":"","willQos":"0","willPayload":""},{"id":"edaa9f3b.acba7","type":"telegrambot-config","z":"","botname":"Beating Heart","usernames":"StrikingVampire,K_irsten","chatIds":"932931836,1014836535","pollInterval":"300"},{"id":"7511f7e9.e3aef8","type":"ui_tab","z":"","name":"Home","icon":"dashboard","disabled":false,"hidden":false},{"id":"4aabbc21.c45ca4","type":"ui_group","z":"","name":"Lights","tab":"7511f7e9.e3aef8","disp":true,"width":"6","collapse":false},{"id":"3ebf4341.e571dc","type":"cast-to-client","z":"84c236a0.d32b58","name":"Google Nest Mini Black","url":"","contentType":"","message":"","language":"","ip":"192.168.1.230","port":"","volume":"","x":850,"y":300,"wires":[[]]},{"id":"f9ffe2f3.6dfa5","type":"cast-to-client","z":"84c236a0.d32b58","name":"Google Nest Mini White","url":"","contentType":"","message":"","language":"nl","ip":"192.168.1.231","port":"","volume":"","x":850,"y":360,"wires":[[]]},{"id":"b1fbd0ed.c429b","type":"change","z":"84c236a0.d32b58","name":"set volume","rules":[{"t":"set","p":"payload.volume","pt":"msg","to":"30","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":300,"wires":[["3ebf4341.e571dc"]]},{"id":"bf1f8fee.78142","type":"change","z":"84c236a0.d32b58","name":"set volume","rules":[{"t":"set","p":"payload.volume","pt":"msg","to":"20","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":650,"y":360,"wires":[["f9ffe2f3.6dfa5"]]},{"id":"85b53517.1d2558","type":"mqtt out","z":"cb03a6ee.c51ce8","name":"","topic":"striva/f/deurbel","qos":"1","retain":"","broker":"a6fb0933.f024a8","x":280,"y":60,"wires":[]},{"id":"73d4d693.890d58","type":"inject","z":"cb03a6ee.c51ce8","name":"Push","topic":"deurbel","payload":"true","payloadType":"bool","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":110,"y":60,"wires":[["85b53517.1d2558"]]},{"id":"ecb93435.c49ff8","type":"mqtt in","z":"cb03a6ee.c51ce8","name":"","topic":"striva/f/deurbel","qos":"1","datatype":"json","broker":"a6fb0933.f024a8","x":120,"y":200,"wires":[["de009c82.fc62b"]]},{"id":"de009c82.fc62b","type":"change","z":"cb03a6ee.c51ce8","name":"Chime","rules":[{"t":"set","p":"payload","pt":"msg","to":"{\"message\":\"Ding dong\",\"language\":\"en\"}","tot":"json"}],"action":"","property":"","from":"","to":"","reg":false,"x":290,"y":200,"wires":[["e0a02e6d.3f02e","c2e443bc.18aa2","e5d88cf1.def83"]]},{"id":"e0a02e6d.3f02e","type":"subflow:84c236a0.d32b58","z":"cb03a6ee.c51ce8","name":"","env":[],"x":470,"y":200,"wires":[]},{"id":"55e56a51.8616e4","type":"time-range-switch","z":"84c236a0.d32b58","name":"08:00 - 19:00","lat":"","lon":"","startTime":"08:00","endTime":"19:00","startOffset":0,"endOffset":0,"x":410,"y":360,"wires":[["bf1f8fee.78142"],[]]},{"id":"c2e443bc.18aa2","type":"telegrambot-notify","z":"cb03a6ee.c51ce8","name":"Send message to Tom","bot":"edaa9f3b.acba7","chatId":"932931836","message":"Someone's at the door!","parseMode":"","x":480,"y":280,"wires":[]},{"id":"9a6d425c.fbd2","type":"inject","z":"81b232fa.7ea2a","name":"0: on","topic":"","payload":"{\"index\":0,\"state\":\"ON\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":40,"wires":[["e71bcf43.55a15"]]},{"id":"c677029f.85273","type":"mqtt out","z":"81b232fa.7ea2a","name":"","topic":"","qos":"","retain":"true","broker":"a6fb0933.f024a8","x":810,"y":180,"wires":[]},{"id":"e71bcf43.55a15","type":"template","z":"81b232fa.7ea2a","name":"","field":"topic","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"lights/{{payload.index}}","output":"str","x":300,"y":180,"wires":[["efddfc14.0fdee"]]},{"id":"ee5201d.98cba","type":"inject","z":"81b232fa.7ea2a","name":"5: on","topic":"","payload":"{\"index\":5,\"state\":\"ON\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":80,"wires":[["e71bcf43.55a15"]]},{"id":"3a8048eb.eda318","type":"inject","z":"81b232fa.7ea2a","name":"8: on","topic":"","payload":"{\"index\":8,\"state\":\"ON\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":120,"wires":[["e71bcf43.55a15"]]},{"id":"c5007774.0e81b8","type":"inject","z":"81b232fa.7ea2a","name":"10: on","topic":"","payload":"{\"index\":10,\"state\":\"ON\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":160,"wires":[["e71bcf43.55a15"]]},{"id":"28444f57.332e3","type":"inject","z":"81b232fa.7ea2a","name":"0: off","topic":"","payload":"{\"index\":0,\"state\":\"OFF\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":200,"wires":[["e71bcf43.55a15"]]},{"id":"cefe7f38.47633","type":"inject","z":"81b232fa.7ea2a","name":"5: off","topic":"","payload":"{\"index\":5,\"state\":\"OFF\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":240,"wires":[["e71bcf43.55a15"]]},{"id":"aa9ae764.8bd488","type":"inject","z":"81b232fa.7ea2a","name":"8: off","topic":"","payload":"{\"index\":8,\"state\":\"OFF\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":280,"wires":[["e71bcf43.55a15"]]},{"id":"209e7eb9.d569a2","type":"inject","z":"81b232fa.7ea2a","name":"10: off","topic":"","payload":"{\"index\":10,\"state\":\"OFF\"}","payloadType":"json","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":320,"wires":[["e71bcf43.55a15"]]},{"id":"efddfc14.0fdee","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.state","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":480,"y":180,"wires":[["c677029f.85273"]]},{"id":"b58648fb.5d4ea8","type":"webhookrelay","z":"81b232fa.7ea2a","buckets":"ifttt","x":80,"y":500,"wires":[["a43b91cf.516a2","e89316c5.427408"]]},{"id":"b368aefd.13248","type":"json","z":"81b232fa.7ea2a","name":"","property":"payload","action":"","pretty":false,"x":520,"y":500,"wires":[["c7ac5338.7b993"]]},{"id":"c7ac5338.7b993","type":"switch","z":"81b232fa.7ea2a","name":"","property":"payload.action","propertyType":"msg","rules":[{"t":"eq","v":"lights_livingroom_on","vt":"str"},{"t":"eq","v":"lights_livingroom_off","vt":"str"},{"t":"eq","v":"lights_kitchen_on","vt":"str"},{"t":"eq","v":"lights_kitchen_off","vt":"str"}],"checkall":"true","repair":false,"outputs":4,"x":250,"y":560,"wires":[["25c0d12f.e1fd8e"],["a9009f54.7655f"],["f5cc80ab.3b33e"],["7b9e535e.04779c"]]},{"id":"25c0d12f.e1fd8e","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"ON","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"lights/0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":560,"wires":[["c677029f.85273"]]},{"id":"a9009f54.7655f","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"OFF","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"lights/0","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":600,"wires":[["c677029f.85273"]]},{"id":"f5cc80ab.3b33e","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"ON","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"lights/5","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":640,"wires":[["c677029f.85273"]]},{"id":"7b9e535e.04779c","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"OFF","tot":"str"},{"t":"set","p":"topic","pt":"msg","to":"lights/5","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":540,"y":680,"wires":[["c677029f.85273"]]},{"id":"a43b91cf.516a2","type":"change","z":"81b232fa.7ea2a","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"payload.body","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":280,"y":500,"wires":[["b368aefd.13248"]]},{"id":"9bc40078.8a385","type":"inject","z":"c123c82a.2bd618","name":"Preset 12","topic":"","payload":"PL=12","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":80,"wires":[["fc42c45b.b19048"]]},{"id":"fc42c45b.b19048","type":"mqtt out","z":"c123c82a.2bd618","name":"WLED","topic":"wled/b3cd8d/api","qos":"1","retain":"true","broker":"a6fb0933.f024a8","x":340,"y":80,"wires":[]},{"id":"e21f0f0b.51d29","type":"inject","z":"c123c82a.2bd618","name":"On/off","topic":"","payload":"T=2","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":90,"y":40,"wires":[["fc42c45b.b19048"]]},{"id":"bd412546.7c80d8","type":"inject","z":"c123c82a.2bd618","name":"Preset 15","topic":"","payload":"PL=15","payloadType":"str","repeat":"","crontab":"","once":false,"onceDelay":0.1,"x":100,"y":120,"wires":[["fc42c45b.b19048"]]},{"id":"e5d88cf1.def83","type":"telegrambot-notify","z":"cb03a6ee.c51ce8","name":"Send message to Kirsten","bot":"edaa9f3b.acba7","chatId":"1014836535","message":"Someone's at the door!","parseMode":"","x":490,"y":340,"wires":[]},{"id":"184555c5.294fea","type":"telegrambot-switch","z":"81b232fa.7ea2a","name":"Which lights?","bot":"edaa9f3b.acba7","chatId":"","question":"Welke lampen wil je bedienen?","answers":["Keuken","Living","Kerstboom"],"outputs":3,"autoAnswerCallback":true,"timeoutValue":"","timeoutUnits":"","x":240,"y":860,"wires":[["ab9eff09.23e7c"],["9ab40c09.c7a9"],["994a38e8.e359a8"]]},{"id":"39d9c4bb.02229c","type":"telegrambot-switch","z":"81b232fa.7ea2a","name":"On/off","bot":"edaa9f3b.acba7","chatId":"","question":"Aan doen, of uit doen?","answers":["Aan","Uit","Verras mij"],"outputs":3,"autoAnswerCallback":true,"timeoutValue":"","timeoutUnits":"","x":750,"y":860,"wires":[["2c4741bb.b2b26e"],["5d3984e4.896d7c"],["5e1606ba.d775b8"]]},{"id":"ab9eff09.23e7c","type":"change","z":"81b232fa.7ea2a","name":"keuken","rules":[{"t":"set","p":"light","pt":"msg","to":"keuken","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":820,"wires":[["39d9c4bb.02229c"]]},{"id":"9ab40c09.c7a9","type":"change","z":"81b232fa.7ea2a","name":"living","rules":[{"t":"set","p":"light","pt":"msg","to":"living","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":860,"wires":[["39d9c4bb.02229c"]]},{"id":"994a38e8.e359a8","type":"change","z":"81b232fa.7ea2a","name":"kerstboom","rules":[{"t":"set","p":"light","pt":"msg","to":"kerstboom","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":510,"y":900,"wires":[["39d9c4bb.02229c"]]},{"id":"2c4741bb.b2b26e","type":"change","z":"81b232fa.7ea2a","name":"aan","rules":[{"t":"set","p":"state","pt":"msg","to":"aan","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":820,"wires":[["ddf49183.47843"]]},{"id":"5d3984e4.896d7c","type":"change","z":"81b232fa.7ea2a","name":"uit","rules":[{"t":"set","p":"state","pt":"msg","to":"uit","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":930,"y":860,"wires":[["ddf49183.47843"]]},{"id":"5e1606ba.d775b8","type":"change","z":"81b232fa.7ea2a","name":"verrassing","rules":[{"t":"set","p":"state","pt":"msg","to":"VERRASSING!","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":950,"y":900,"wires":[["6743c20c.f33c9c"]]},{"id":"c645bb9d.0d8138","type":"telegrambot-notify","z":"81b232fa.7ea2a","name":"","bot":"edaa9f3b.acba7","chatId":"","message":"","parseMode":"","x":1420,"y":840,"wires":[]},{"id":"ddf49183.47843","type":"template","z":"81b232fa.7ea2a","name":"aan/uit message","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Ok, ik doe de {{light}} verlichting {{state}}.","output":"str","x":1180,"y":840,"wires":[["c645bb9d.0d8138"]]},{"id":"6743c20c.f33c9c","type":"template","z":"81b232fa.7ea2a","name":"verrassing message","field":"payload","fieldType":"msg","format":"handlebars","syntax":"mustache","template":"Kijk wat er nu gebeurt met de {{light}} verlichting: FLIKKER FLIKKER!","output":"str","x":1200,"y":900,"wires":[["c645bb9d.0d8138"]]},{"id":"77fee143.711d7","type":"telegrambot-command","z":"81b232fa.7ea2a","name":"lights","bot":"edaa9f3b.acba7","command":"^l(?:(?:ights?)|(?:icht(?:en)?))?$","commandType":"re","commandCase":false,"x":70,"y":860,"wires":[["184555c5.294fea"]]},{"id":"e89316c5.427408","type":"debug","z":"81b232fa.7ea2a","name":"","active":true,"tosidebar":true,"console":false,"tostatus":false,"complete":"true","targetType":"full","x":200,"y":400,"wires":[]},{"id":"735aaac5.ea4a64","type":"ui_switch","z":"81b232fa.7ea2a","name":"","label":"Yellow","tooltip":"","group":"4aabbc21.c45ca4","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"{\"index\":0,\"state\":\"ON\"}","onvalueType":"json","onicon":"","oncolor":"","offvalue":"{\"index\":0,\"state\":\"OFF\"}","offvalueType":"json","officon":"","offcolor":"","x":350,"y":40,"wires":[["e71bcf43.55a15"]]},{"id":"ff8dceb2.2b49e","type":"ui_switch","z":"81b232fa.7ea2a","name":"","label":"Red","tooltip":"","group":"4aabbc21.c45ca4","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"{\"index\":5,\"state\":\"ON\"}","onvalueType":"json","onicon":"","oncolor":"","offvalue":"{\"index\":5,\"state\":\"OFF\"}","offvalueType":"json","officon":"","offcolor":"","x":510,"y":40,"wires":[["e71bcf43.55a15"]]},{"id":"99dc4378.2eb9e","type":"ui_switch","z":"81b232fa.7ea2a","name":"","label":"Blue","tooltip":"","group":"4aabbc21.c45ca4","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"{\"index\":8,\"state\":\"ON\"}","onvalueType":"json","onicon":"","oncolor":"","offvalue":"{\"index\":8,\"state\":\"OFF\"}","offvalueType":"json","officon":"","offcolor":"","x":650,"y":40,"wires":[["e71bcf43.55a15"]]},{"id":"3bcee4bc.02e5fc","type":"ui_switch","z":"81b232fa.7ea2a","name":"","label":"Green","tooltip":"","group":"4aabbc21.c45ca4","order":0,"width":0,"height":0,"passthru":true,"decouple":"false","topic":"","style":"","onvalue":"{\"index\":10,\"state\":\"ON\"}","onvalueType":"json","onicon":"","oncolor":"","offvalue":"{\"index\":10,\"state\":\"OFF\"}","offvalueType":"json","officon":"","offcolor":"","x":790,"y":40,"wires":[["e71bcf43.55a15"]]},{"id":"5d0af138.ca1ee","type":"mqtt in","z":"3332df14.475c4","name":"","topic":"cmnd/button/#","qos":"2","datatype":"auto","broker":"a6fb0933.f024a8","x":120,"y":60,"wires":[["51cd4815.e77578"]]},{"id":"51cd4815.e77578","type":"change","z":"3332df14.475c4","name":"to button","rules":[{"t":"set","p":"button.location","pt":"msg","to":"msg.topic.$split('/')[2]","tot":"jsonata"},{"t":"set","p":"button.device","pt":"msg","to":"msg.topic.$split('/')[3]","tot":"jsonata"},{"t":"set","p":"button.pin","pt":"msg","to":"msg.topic.$split('/')[4]","tot":"jsonata"},{"t":"set","p":"button.state","pt":"msg","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":140,"y":120,"wires":[["1088a141.7da5df","82522ca6.60a9f"]]},{"id":"4fe03f53.14011","type":"switch","z":"3332df14.475c4","name":"button state","property":"button.state","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":330,"y":240,"wires":[["2c06cc2e.23e8c4"],[],[]]},{"id":"1088a141.7da5df","type":"switch","z":"3332df14.475c4","name":"36","property":"button.pin","propertyType":"msg","rules":[{"t":"eq","v":"36","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":180,"wires":[["a017af03.e93be"]]},{"id":"82522ca6.60a9f","type":"switch","z":"3332df14.475c4","name":"37","property":"button.pin","propertyType":"msg","rules":[{"t":"eq","v":"37","vt":"str"}],"checkall":"true","repair":false,"outputs":1,"x":170,"y":240,"wires":[["4fe03f53.14011"]]},{"id":"a017af03.e93be","type":"switch","z":"3332df14.475c4","name":"button state","property":"button.state","propertyType":"msg","rules":[{"t":"eq","v":"single","vt":"str"},{"t":"eq","v":"double","vt":"str"},{"t":"eq","v":"hold","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":330,"y":180,"wires":[["16934199.582b0e"],[],[]]},{"id":"16934199.582b0e","type":"change","z":"3332df14.475c4","name":"toggle","rules":[{"t":"set","p":"payload","pt":"msg","to":"TOGGLE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":160,"wires":[["fbc98e5c.37657"]]},{"id":"b99ec226.bcf7","type":"mqtt in","z":"3332df14.475c4","name":"","topic":"stat/relay/downstairs/1","qos":"2","datatype":"auto","broker":"a6fb0933.f024a8","x":140,"y":840,"wires":[["ecfec4df.d34c38"]]},{"id":"ecfec4df.d34c38","type":"change","z":"3332df14.475c4","name":"","rules":[{"t":"set","p":"relay1","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":840,"wires":[[]]},{"id":"883ceee1.1ba76","type":"mqtt in","z":"3332df14.475c4","name":"","topic":"stat/relay/downstairs/2","qos":"2","datatype":"auto","broker":"a6fb0933.f024a8","x":140,"y":900,"wires":[["2f9d22.be76f2de"]]},{"id":"2f9d22.be76f2de","type":"change","z":"3332df14.475c4","name":"","rules":[{"t":"set","p":"relay2","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":360,"y":900,"wires":[[]]},{"id":"2c9950.2efbb6b","type":"mqtt in","z":"6f1eb918.3cb018","name":"","topic":"stat/relay/#","qos":"2","datatype":"auto","broker":"a6fb0933.f024a8","x":80,"y":380,"wires":[["a570092f.0e5d78"]]},{"id":"5774a88e.5793e8","type":"change","z":"6f1eb918.3cb018","name":"","rules":[{"t":"set","p":"status","pt":"flow","to":"payload","tot":"msg"}],"action":"","property":"","from":"","to":"","reg":false,"x":220,"y":600,"wires":[[]]},{"id":"a570092f.0e5d78","type":"change","z":"6f1eb918.3cb018","name":"to relay","rules":[{"t":"set","p":"relay.location","pt":"msg","to":"msg.topic.$split('/')[2]","tot":"jsonata"},{"t":"set","p":"relay.number","pt":"msg","to":"msg.topic.$split('/')[3]","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":120,"y":440,"wires":[["3471a5bf.4f9a9a"]]},{"id":"3471a5bf.4f9a9a","type":"switch","z":"6f1eb918.3cb018","name":"check location","property":"relay.location","propertyType":"msg","rules":[{"t":"eq","v":"location","vt":"env"}],"checkall":"true","repair":false,"outputs":1,"x":180,"y":500,"wires":[["49f6867e.9709c8"]]},{"id":"49f6867e.9709c8","type":"switch","z":"6f1eb918.3cb018","name":"check number","property":"relay.number","propertyType":"msg","rules":[{"t":"eq","v":"number","vt":"env"}],"checkall":"true","repair":false,"outputs":1,"x":180,"y":540,"wires":[["5774a88e.5793e8"]]},{"id":"fbc98e5c.37657","type":"subflow:6f1eb918.3cb018","z":"3332df14.475c4","name":"Berging beneden","env":[{"name":"location","value":"downstairs","type":"str"},{"name":"number","value":"1","type":"str"}],"x":670,"y":160,"wires":[[]]},{"id":"e0d3f10f.b6248","type":"switch","z":"6f1eb918.3cb018","name":"ON/OFF/TOGGLE","property":"payload","propertyType":"msg","rules":[{"t":"eq","v":"ON","vt":"str"},{"t":"eq","v":"OFF","vt":"str"},{"t":"eq","v":"TOGGLE","vt":"str"}],"checkall":"true","repair":false,"outputs":3,"x":190,"y":40,"wires":[["110635fa.9bf96a"],["110635fa.9bf96a"],["6b4d3959.d9e0f8"]]},{"id":"110635fa.9bf96a","type":"change","z":"6f1eb918.3cb018","name":"","rules":[{"t":"set","p":"topic","pt":"msg","to":"$join(\t   [\t       'cmnd',\t       'relay',\t       $env('location'),\t       $env('number')\t   ],\t   '/'\t)\t","tot":"jsonata"}],"action":"","property":"","from":"","to":"","reg":false,"x":500,"y":140,"wires":[["6dc12494.f3507c"]]},{"id":"6dc12494.f3507c","type":"mqtt out","z":"6f1eb918.3cb018","name":"","topic":"","qos":"2","retain":"true","broker":"a6fb0933.f024a8","x":670,"y":140,"wires":[]},{"id":"6b4d3959.d9e0f8","type":"switch","z":"6f1eb918.3cb018","name":"toggle","property":"status","propertyType":"flow","rules":[{"t":"eq","v":"ON","vt":"str"},{"t":"else"}],"checkall":"true","repair":false,"outputs":2,"x":170,"y":120,"wires":[["aab437ea.ab0898"],["34d3ff1c.a4d94"]]},{"id":"34d3ff1c.a4d94","type":"change","z":"6f1eb918.3cb018","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"ON","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":220,"wires":[["110635fa.9bf96a"]]},{"id":"aab437ea.ab0898","type":"change","z":"6f1eb918.3cb018","name":"","rules":[{"t":"set","p":"payload","pt":"msg","to":"OFF","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":260,"y":180,"wires":[["110635fa.9bf96a"]]},{"id":"2c06cc2e.23e8c4","type":"change","z":"3332df14.475c4","name":"toggle","rules":[{"t":"set","p":"payload","pt":"msg","to":"TOGGLE","tot":"str"}],"action":"","property":"","from":"","to":"","reg":false,"x":490,"y":220,"wires":[["92c7c971.df4e18"]]},{"id":"92c7c971.df4e18","type":"subflow:6f1eb918.3cb018","z":"3332df14.475c4","name":"Gang beneden","env":[{"name":"location","value":"downstairs","type":"str"},{"name":"number","value":"2","type":"str"}],"x":660,"y":220,"wires":[[]]}]